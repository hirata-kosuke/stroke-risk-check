# 脳卒中・循環器疾患リスクチェック WEBアプリ

JPHC研究（国立がん研究センター）に基づく、10年間の脳卒中および循環器疾患発症リスクを評価するWEBアプリケーションです。

## 機能

### 基本機能（脳卒中リスク評価）

- 7つのリスク因子に基づくリスク評価
  - 年齢（40-69歳）
  - 性別
  - 喫煙習慣
  - BMI（身長・体重から自動計算）
  - 血圧
  - 降圧剤服用の有無
  - 糖尿病の有無
- 10年間の脳卒中発症確率の推定
- 4段階のリスクレベル判定
- 結果の印刷機能

### 拡張機能（循環器疾患リスク評価）

コレステロール値を入力すると、以下の追加評価が可能です：

- **脳梗塞リスク**の個別評価
- **心筋梗塞リスク**の評価
- **脳卒中全体リスク**（脳梗塞+脳内出血+くも膜下出血）
- **推定血管年齢**の算出

必要な追加項目：
- HDLコレステロール
- LDLコレステロール（または総コレステロール）
- 中性脂肪（オプション）

## 技術スタック

- React 19
- TypeScript
- Vite
- react-router-dom
- Supabase（データベース - オプション）
- lucide-react（アイコン）

## デプロイ（公開）

### Vercel で無料公開（推奨）

詳しくは [VERCEL_DEPLOY_GUIDE.md](VERCEL_DEPLOY_GUIDE.md) を参照してください。

**簡易手順**:

1. Git リポジトリのセットアップ
   ```bash
   setup_git.bat
   ```

2. GitHub にプッシュ（リモートリポジトリ作成後）
   ```bash
   push_to_github.bat
   ```

3. Vercel でインポート
   - https://vercel.com でサインアップ
   - GitHub リポジトリをインポート
   - 自動的にデプロイ完了

**公開URL例**: `https://stroke-risk-check-xxxxx.vercel.app`

### Google Sheets 連携（オプション）

データを Google スプレッドシートで管理する場合は [GOOGLE_SHEETS_SETUP.md](GOOGLE_SHEETS_SETUP.md) を参照してください。

---

## ローカル開発

### 1. 依存関係のインストール

```bash
npm install
```

### 2. 開発サーバーの起動

```bash
npm run dev
```

ブラウザで http://localhost:5173/ にアクセスしてください。

### 3. Supabaseの設定（オプション）

データを保存する場合は、Supabaseの設定が必要です。

1. `.env.example` を `.env` にコピー
2. Supabase プロジェクトを作成
3. `.env` に環境変数を設定
4. `SUPABASE_SETUP.md` の手順に従ってデータベースをセットアップ

## スコア計算式について

### 脳卒中リスク評価

✅ **JPHC研究の正式なスコアリングテーブルに基づき実装済み**

国立がん研究センターが公開している正確なスコア配分表を使用しています。

#### 検証済みの具体例

- **例1**: 50歳男性、喫煙、BMI27.3、糖尿病あり、降圧剤服用 → **35点 → 10-12%** ✓
- **例2**: 58歳男性、喫煙、BMI26、糖尿病あり、血圧145/89 → **39点 → 12-15%** ✓

### 循環器疾患リスク評価

⚠️ **暫定的な計算式を使用**

コレステロール値を含む循環器疾患リスク（脳梗塞、心筋梗塞、血管年齢）の計算式は、医学的知見に基づく暫定値です。より正確な評価には、国立がん研究センターの公式ツールをご利用ください。

#### 参考資料

詳細は以下のファイルを参照してください：
- [SCORING_INFO.md](./SCORING_INFO.md) - スコア配分の詳細（正式なテーブル）
- [TEST_CASES.md](./TEST_CASES.md) - テストケースと検証結果

## プロジェクト構造

```
stroke-risk-check/
├── src/
│   ├── pages/           # 画面コンポーネント
│   │   ├── ConsentPage.tsx       # 同意画面
│   │   ├── BasicInfoPage.tsx     # 基本情報入力
│   │   ├── RiskCheckPage.tsx     # リスクチェック
│   │   └── ResultPage.tsx        # 結果表示
│   ├── types/           # 型定義
│   │   └── stroke.ts
│   ├── utils/           # ユーティリティ
│   │   └── evaluation.ts         # リスク評価ロジック
│   ├── lib/             # ライブラリ設定
│   │   └── supabase.ts
│   ├── App.tsx          # ルーティング
│   └── App.css          # スタイル
├── .env.example         # 環境変数テンプレート
├── SUPABASE_SETUP.md    # データベースセットアップ手順
├── SCORING_INFO.md      # スコア計算の詳細
└── TEST_CASES.md        # テストケース
```

## 画面フロー

1. **同意画面** (/) - 利用規約と個人情報の取り扱いへの同意
2. **基本情報入力** (/basic-info) - 名前、年齢、性別
3. **リスクチェック** (/risk-check) - 7つのリスク因子を入力
4. **入力内容確認** (/confirm) - 全入力項目の一覧表示と確認
5. **結果表示** (/result) - リスク評価結果と推奨事項

## ビルド

```bash
npm run build
```

ビルドされたファイルは `dist/` ディレクトリに出力されます。

## 免責事項

このツールは統計的な推定を行うものであり、医師の診断に代わるものではありません。
健康上の不安がある場合は、必ず医療機関を受診してください。

## 出典

- JPHC研究（多目的コホート研究）
- 国立研究開発法人 国立がん研究センター
- https://epi.ncc.go.jp/jphc/outcome/3284.html

## ライセンス

MIT

## 作成日

2026年1月15日
